<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
     
    <html xmlns="http://www.w3.org/1999/xhtml">
    
<head>   
    
     
    <script type="text/javascript" src="http://c.csdnimg.cn/pubfooter/js/tracking.js" charset="utf-8"></script>  

    <script type="text/javascript">
        var protocol = window.location.protocol;
        document.write('<script type="text/javascript" src="' + protocol + '//csdnimg.cn/pubfooter/js/repoAddr2.js?v=' + Math.random() + '"></' + 'script>');
    </script>

     <script id="allmobilize" charset="utf-8" src="http://a.yunshipei.com/46aae4d1e2371e4aa769798941cef698/allmobilize.min.js"></script>
 <meta http-equiv="Cache-Control" content="no-siteapp" /><link rel="alternate" media="handheld" href="#" />

    <title>从HTML文件中抽取正文的简单方案 - 赖勇浩的编程私伙局
        - 博客频道 - CSDN.NET</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="转载地址：本示例代码说明：基于最新开发包Android&#160;sdkv2.1.3 开发的测距功能DEMO，且手把手教会您配置KEY及运行DEMO的方法示例操作：点击DEMO界面的“start” 开始测距，在手机屏幕上选择测距点，finish 结束测距&#160;&#160;示例安装到运行方法，手把手教会你：&#160; &#160;&#160;&#160;&#160; &#160;&#160;&#160;key的步骤：&#160; &#160;&#160;&#160;1） 申请ke" />
    <script src="http://static.blog.csdn.net/scripts/jquery.js" type="text/javascript"></script>
    <script type="text/javascript" src="http://static.blog.csdn.net/scripts/ad.js?v=1.1"></script>
        <!--new top-->
               <link rel="stylesheet" href="http://static.csdn.net/public/common/toolbar/css/index.css">        <!--new top-->

    <link rel="Stylesheet" type="text/css" href="http://static.blog.csdn.net/skin/ink/css/style.css?v=1.1" />
    <link id="RSSLink" title="RSS" type="application/rss+xml" rel="alternate" href="/lanphaday/rss/list" />
    <link rel="shortcut icon" href="http://c.csdnimg.cn/public/favicon.ico" />
    <link type="text/css" rel="stylesheet" href="http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/default.css" />
 


</head>
<body>
    
   
      <!--new top-->
    <script id="toolbar-tpl-scriptId" fixed="true" prod="blog" skin="black" src="http://static.csdn.net/public/common/toolbar/js/html.js" type="text/javascript"></script>
     <!--new top-->
    <div id="container">
        <div id="header">
    <div class="header">
        <div id="blog_title">
            <h2>
                <a href="http://blog.csdn.net/gzlaiyonghao">赖勇浩的编程私伙局</a></h2>
            <h3>game -&gt; webgame -&gt; web，一路走来，风雨兼程。</h3>
            <div class="clear">
            </div>
        </div>
        <div class="clear">
        </div>
    </div>
</div>
<div id="navigator">
    <div class="navigator_bg">
    </div>
    <div class="navigator">
        <ul>
            
                <li id="btnContents"><a href="http://blog.csdn.net/gzlaiyonghao?viewmode=contents"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_mulu'])">
                    <img src="http://static.blog.csdn.net/images/ico_list.gif">目录视图</span></a></li>
                <li id="btnView"><a href="http://blog.csdn.net/gzlaiyonghao?viewmode=list"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_zhaiyao'])">
                    <img src="http://static.blog.csdn.net/images/ico_summary.gif">摘要视图</span></a></li>
                <li id="btnRss"><a href="http://blog.csdn.net/gzlaiyonghao/rss/list"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_RSS'])">
                    <img src="http://static.blog.csdn.net/images/ico_rss.gif">订阅</span></a></li>                

            </ul>
    </div>
</div>
<script type="text/javascript">
    var username = "lanphaday";
    var _blogger = username;
    var blog_address = "http://blog.csdn.net/gzlaiyonghao";
    var static_host = "http://static.blog.csdn.net";
    var currentUserName = "huangxx";  
</script>

        <div id="body">
            <div id="main">
                <div class="main">
                        <div class="ad_class">
<div class="notice tracking-ad" data-mod='popu_3' > 

<a href="http://bbs.csdn.net/topics/391491253"><font color=red>
社区趴北京站，多图慎入</font></a>
&nbsp;&nbsp;&nbsp;
  

<a href="http://huiyi.csdn.net/activity/product/goods_list?project_id=2215">
<font color=blue>Android开发，8月14开课啦！
</font></a>
&nbsp;&nbsp;&nbsp;

<a href="http://blog.csdn.net/blogdevteam/article/details/47256525">
<font color=red>【面向社区】极客头条使用体验征文
</font></a>
&nbsp;&nbsp;&nbsp;
<a href="http://www.csdn.net/app/">
<font color=blue>CSDN移动客户端，下载送50C币
</font></a>
&nbsp;&nbsp;&nbsp;</div>                        </div>
                        

  
<link href="http://static.blog.csdn.net/css/comment1.css" type="text/css" rel="stylesheet" />
<link href="http://static.blog.csdn.net/css/style1.css" type="text/css" rel="stylesheet" />
<script language='JavaScript' type='text/javascript' src='http://download.csdn.net/js/jquery.cookie.js'></script>
<script type="text/javascript" src="http://c.csdnimg.cn/rabbit/search-service/main.js"></script>
<link rel="stylesheet" href="http://static.blog.csdn.net/public/res-min/markdown_views.css?v=1.0" />
<script type="text/javascript" src="http://static.blog.csdn.net/public/res/bower-libs/MathJax/MathJax.js?config=TeX-AMS_HTML"></script>

  <script type="text/ecmascript">
      window.quickReplyflag = true;
    </script>
<div id="article_details" class="details">
    <div class="article_title">   
         <span class="ico ico_type_Translated"></span>


    <h1>
        <span class="link_title"><a href="/gzlaiyonghao/article/details/1741185">
        从HTML文件中抽取正文的简单方案            
        </a>
        </span>
    </h1>
</div>

   

    <div class="article_manage">
        <span class="link_categories">
        分类：
            <a href="/lanphaday/article/category/328650" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_fenlei']);">Data Mining</a> 
            <a href="/lanphaday/article/category/328646" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_fenlei']);">Python</a> 
            <a href="/lanphaday/article/category/328653" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_fenlei']);">Translation</a> 
            <a href="/lanphaday/article/category/328660" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_fenlei']);">Univeral AI</a> 
            <a href="/lanphaday/article/category/328685" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_fenlei']);">Algorithms</a> 
        </span>
    <span class="link_postdate">2007-08-13 19:09</span>
    <span class="link_view" title="阅读次数">24404人阅读</span>
    <span class="link_comments" title="评论次数"><a href="#comments" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_pinglun'])">评论</a>(24)</span>
    <span class="link_collect"><a href="javascript:void(0);" onclick="javascript:collectArticle('从HTML文件中抽取正文的简单方案','1741185');return false;" title="收藏">收藏</a></span>
    <span class="link_report"><a href="#report"  onclick="javascript:report(1741185,2);return false;" title="举报">举报</a></span>
    
</div>
<div class="tag2box"><a href='http://www.csdn.net/tag/html' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">html</a><a href='http://www.csdn.net/tag/output' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">output</a><a href='http://www.csdn.net/tag/parsing' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">parsing</a><a href='http://www.csdn.net/tag/network' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">network</a><a href='http://www.csdn.net/tag/filter' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">filter</a><a href='http://www.csdn.net/tag/attributes' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">attributes</a></div>

  

  
  
     

<div id="article_content" class="article_content">
<p><span style="color: #ff0000;"><span style="background-color: #ffffff;">2011.04.08 更新：想找此方案的代码的朋友请访问：http://code.google.com/p/creamer</span>
</span>
 
</p>
<p>
<hr />
<strong><span style="FONT-SIZE: 18pt">从HTML文件中抽取正文的简单方案</span>

</strong>
</p>
<div>
</div>
<div><span style="FONT-SIZE: 12pt">作者：alexjc</span>

</div>
<div><span style="FONT-SIZE: 12pt">译者：恋花蝶（http://blog.csdn.net/lanphaday）</span>

</div>
<div><span style="FONT-SIZE: 12pt">原文地址：http://ai-depot.com/articles/the-easy-way-to-extract-useful-text-from-arbitrary-html/</span>

</div>
<p>&nbsp;</p>
<div><span style="FONT-SIZE: 12pt"><span style="color: #0000ff;">译者导读：这篇文章主要介绍了从不同类型的HTML文件中抽取出真正有用的正文内容的一种有广泛适应性的方法。其功能类似于CSDN近期推出的&ldquo;剪影&rdquo;，能够去除页眉、页脚和侧边栏的无关内容，非常实用。其方法简单有效而又出乎意料，看完后难免大呼原来还可以这样！行文简明易懂，虽然应用了人工神经网络这样的算法，但因为FANN良好的封装性，并不要求读者需要懂得ANN。全文示例以Python代码写成，可读性更佳，具有科普气息，值得一读。</span>

</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">You&rsquo;ve finally got your hands on the diverse collection of HTML documents you needed. But the content you&rsquo;re interested in is hidden amidst adverts, layout tables or formatting markup, and other various links. Even worse, there&rsquo;s visible text in the menus, headers and footers that you want to filter out. If you don&rsquo;t want to write a complex scraping program for each type of HTML file, there is a solution.</span>

</div>
<div><span style="FONT-SIZE: 12pt">每个人手中都可能有一大堆讨论不同话题的HTML文档。但你真正感兴趣的内容可能隐藏于广告、布局表格或格式标记以及无数链接当中。甚至更糟的是，你希望那些来自菜单、页眉和页脚的文本能够被过滤掉。如果你不想为每种类型的HTML文件分别编写复杂的抽取程序的话，我这里有一个解决方案。</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">This article shows you how to write a relatively simple script to extract text paragraphs from large chunks of HTML code, without knowing its structure or the tags used. It works on news articles and blogs pages with worthwhile text content, among others&hellip;</span>

</div>
<div><span style="FONT-SIZE: 12pt">本文讲述如何编写与从大量HTML代码中获取正文内容的简单脚本，这一方法无需知道HTML文件的结构和使用的标签。它能够工作于含有文本内容的所有新闻文章和博客页面&hellip;&hellip;</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">Do you want to find out how statistics and machine learning can save you time and effort mining text?</span>

</div>
<div><span style="FONT-SIZE: 12pt">你想知道统计学和机器学习在挖掘文本方面能够让你省时省力的原因吗？</span>

</div>
<p align="left"><span style="FONT-SIZE: 12pt; COLOR: silver">

The concept is rather simple: use information about the density of text vs. HTML code to work out if a line of text is worth outputting. (This isn&rsquo;t a novel idea, but it works!) The basic process works as follows:</span>

</p>
<div><span style="FONT-SIZE: 12pt">答案极其简单：使用文本和HTML代码的密度来决定一行文件是否应该输出。（这听起来有点离奇，但它的确有用！）基本的处理工作如下：</span>

</div>
<ol type="1">
<li style="COLOR: silver; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">Parse the HTML code and keep track of the number of bytes processed. </span>

</li>
</ol>
<div style="MARGIN-LEFT: 18pt"><span style="FONT-SIZE: 12pt">一、解析HTML代码并记下处理的字节数。</span>

</div>
<ol type="1">
<li style="COLOR: silver; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">Store the text output on a per-line, or per-paragraph basis. </span>

</li>
</ol>
<div style="MARGIN-LEFT: 18pt"><span style="FONT-SIZE: 12pt">二、以行或段的形式保存解析输出的文本。</span>

</div>
<ol type="1">
<li style="COLOR: silver; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">Associate with each text line the number of bytes of HTML required to describe it. </span>

</li>
</ol>
<div style="MARGIN-LEFT: 18pt"><span style="FONT-SIZE: 12pt">三、统计每一行文本相应的HTML代码的字节数</span>

</div>
<ol type="1">
<li style="COLOR: silver; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">Compute the text density of each line by calculating the ratio of text to bytes. </span>

</li>
</ol>
<div style="MARGIN-LEFT: 18pt"><span style="FONT-SIZE: 12pt">四、通过计算文本相对于字节数的比率来获取文本密度</span>

</div>
<ol type="1">
<li style="COLOR: silver; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">Then decide if the line is part of the content by using a neural network. </span>

</li>
</ol>
<div style="MARGIN-LEFT: 18pt"><span style="FONT-SIZE: 12pt">五、最后用神经网络来决定这一行是不是正文的一部分。</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">You can get pretty good results just by checking if the line&rsquo;s density is above a fixed threshold (or the average), but the system makes fewer mistakes if you use machine learning &mdash; not to mention that it&rsquo;s easier to implement!</span>

</div>
<div><span style="FONT-SIZE: 12pt">仅仅通过判断行密度是否高于一个固定的阈值（或者就使用平均值）你就可以获得非常好的结果。但你也可以使用机器学习（这易于实现，简直不值一提）来减少这个系统出现的错误。</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">Let&rsquo;s take it from the top&hellip;</span>

</div>
<div><span style="FONT-SIZE: 12pt">现在让我从头开始&hellip;&hellip;</span>

</div>
<div><strong><span style="FONT-SIZE: 13.5pt">Converting the HTML to Text</span>

</strong>

</div>
<div><strong><span style="FONT-SIZE: 13.5pt">转换HTML为文本</span>

</strong>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">What you need is the core of a text-mode browser, which is already setup to read files with HTML markup and display raw text. By reusing existing code, you won&rsquo;t have to spend too much time handling invalid XML documents, which are very common &mdash; as you&rsquo;ll realise quickly.</span>

</div>
<div><span style="FONT-SIZE: 12pt">你需要一个文本模式浏览器的核心，它应该已经内建了读取HTML文件和显示原始文本功能。通过重用已有代码，你并不需要把很多时间花在处理无效的XML文件上。</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">As a quick example, we&rsquo;ll be using <a href="http://python.org/"><span style="COLOR: silver; TEXT-DECORATION: none; text-underline: none">Python</span>

</a>

 along with a few built-in modules: htmllib for the parsing and formatter for outputting formatted text. This is what the top-level function looks like:</span>

</div>
<div><span style="FONT-SIZE: 12pt">我们将使用Python来完成这个例子，它的htmllib模块可用以解析HTML文件，formatter模块可用以输出格式化的文本。嗯，实现的顶层函数如下：</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><strong><span style="FONT-SIZE: 12pt; COLOR: #7777ff">def</span>

</strong>

<span style="FONT-SIZE: 12pt"> extract_text<span style="COLOR: black">(</span>

html<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <em><span style="COLOR: gray"># Derive from formatter.AbstractWriter to store paragraphs.</span>

</em>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; writer = LineWriter<span style="COLOR: black">()</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <em><span style="COLOR: gray"># Default formatter sends commands to our writer.</span>

</em>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <span style="COLOR: #808040">formatter</span>

 = AbstractFormatter<span style="COLOR: black">(</span>

writer<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <em><span style="COLOR: gray"># Derive from htmllib.HTMLParser to track parsed bytes.</span>

</em>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <span style="COLOR: #808040">parser</span>

 = TrackingParser<span style="COLOR: black">(</span>

writer, <span style="COLOR: #808040">formatter</span>

<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <em><span style="COLOR: gray"># Give the parser the raw HTML data.</span>

</em>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <span style="COLOR: #808040">parser</span>

.<span style="COLOR: black">feed(</span>

html<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <span style="COLOR: #808040">parser</span>

.<span style="COLOR: black">close()</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <em><span style="COLOR: gray"># Filter the paragraphs stored and output them.</span>

</em>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">return</span>

</strong>

 writer.<span style="COLOR: black">output()</span>

</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">The TrackingParser itself overrides the callback functions for parsing start and end tags, as they are given the current parse index in the buffer. You don&rsquo;t have access to that normally, unless you start diving into frames in the call stack &mdash; which isn&rsquo;t the best approach! Here&rsquo;s what the class looks like:</span>

</div>
<div><span style="FONT-SIZE: 12pt">TrackingParser</span>

<span style="FONT-SIZE: 12pt">覆盖了解析标签开始和结束时调用的回调函数，用以给缓冲对象传递当前解析的索引。通常你不得不这样，除非你使用不被推荐的方法&mdash;&mdash;深入调用堆栈去获取执行帧。这个类看起来是这样的：</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><strong><span style="FONT-SIZE: 12pt; COLOR: #7777ff">class</span>

</strong>

<span style="FONT-SIZE: 12pt"> TrackingParser<span style="COLOR: black">(</span>

<span style="COLOR: #808040">htmllib</span>

.<span style="COLOR: #808040">HTMLParser</span>

<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <span style="COLOR: #48488b">&quot;&quot;&quot;Try to keep accurate pointer of parsing location.&quot;&quot;&quot;</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">def</span>

</strong>

 <span style="COLOR: mediumblue">__init__</span>

<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

, writer, *args<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #808040">htmllib</span>

.<span style="COLOR: #808040">HTMLParser</span>

.<span style="COLOR: mediumblue">__init__</span>

<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

, *args<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">writer</span>

 = writer</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">def</span>

</strong>

 parse_starttag<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

, i<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index = <span style="COLOR: #808040">htmllib</span>

.<span style="COLOR: #808040">HTMLParser</span>

.<span style="COLOR: black">parse_starttag(</span>

<span style="COLOR: #a0a020">self</span>

, i<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">writer</span>

.<span style="COLOR: black">index</span>

 = index</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">return</span>

</strong>

 index</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">def</span>

</strong>

 parse_endtag<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

, i<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">writer</span>

.<span style="COLOR: black">index</span>

 = i</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">return</span>

</strong>

 <span style="COLOR: #808040">htmllib</span>

.<span style="COLOR: #808040">HTMLParser</span>

.<span style="COLOR: black">parse_endtag(</span>

<span style="COLOR: #a0a020">self</span>

, i<span style="COLOR: black">)</span>

</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">The LineWriter class does the bulk of the work when called by the default formatter. If you have any improvements or changes to make, most likely they&rsquo;ll go here. This is where we&rsquo;ll put our machine learning code in later. But you can keep the implementation rather simple and still get good results. Here&rsquo;s the simplest possible code:</span>

</div>
<div><span style="FONT-SIZE: 12pt">LinWriter</span>

<span style="FONT-SIZE: 12pt">的大部分工作都通过调用formatter来完成。如果你要改进或者修改程序，大部分时候其实就是在修改它。我们将在后面讲述怎么为它加上机器学习代码。但你也可以保持它的简单实现，仍然可以得到一个好结果。具体的代码如下：</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><strong><span style="FONT-SIZE: 12pt; COLOR: #7777ff">class</span>

</strong>

<span style="FONT-SIZE: 12pt"> Paragraph:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">def</span>

</strong>

 <span style="COLOR: mediumblue">__init__</span>

<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">text</span>

 = <span style="COLOR: #48488b">''</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">bytes</span>

 = <span style="COLOR: #454580">0</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">density</span>

 = <span style="COLOR: #454580">0.0</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><strong><span style="FONT-SIZE: 12pt; COLOR: #7777ff">class</span>

</strong>

<span style="FONT-SIZE: 12pt"> LineWriter<span style="COLOR: black">(</span>

<span style="COLOR: #808040">formatter</span>

.<span style="COLOR: black">AbstractWriter)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">def</span>

</strong>

 <span style="COLOR: mediumblue">__init__</span>

<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

, *args<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">last_index</span>

 = <span style="COLOR: #454580">0</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">lines</span>

 = <span style="COLOR: black">[</span>

Paragraph<span style="COLOR: black">()]</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #808040">formatter</span>

.<span style="COLOR: black">AbstractWriter</span>

.<span style="COLOR: mediumblue">__init__</span>

<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">def</span>

</strong>

 send_flowing_data<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

, data<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em><span style="COLOR: gray"># Work out the length of this text chunk.</span>

</em>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;t = <span style="COLOR: #a0a020">len</span>

<span style="COLOR: black">(</span>

data<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em><span style="COLOR: gray"># We've parsed more text, so increment index.</span>

</em>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">index</span>

 += t</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em><span style="COLOR: gray"># Calculate the number of bytes since last time.</span>

</em>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b = <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">index</span>

 - <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">last_index</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">last_index</span>

 = <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">index</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em><span style="COLOR: gray"># Accumulate this information in current line.</span>

</em>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; l = <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">lines[</span>

<span style="COLOR: #454580">-1</span>

<span style="COLOR: black">]</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; l.<span style="COLOR: black">text</span>

 += data</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; l.<span style="COLOR: black">bytes</span>

 += b</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">def</span>

</strong>

 send_paragraph<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

, blankline<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #48488b">&quot;&quot;&quot;Create a new paragraph if necessary.&quot;&quot;&quot;</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">if</span>

</strong>

 <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">lines[</span>

<span style="COLOR: #454580">-1</span>

<span style="COLOR: black">]</span>

.<span style="COLOR: black">text</span>

 == <span style="COLOR: #48488b">''</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">return</span>

</strong>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">lines[</span>

<span style="COLOR: #454580">-1</span>

<span style="COLOR: black">]</span>

.<span style="COLOR: black">text</span>

 += <span style="COLOR: #48488b">'n'</span>

 * <span style="COLOR: black">(</span>

blankline<span style="COLOR: #454580">+1</span>

<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">lines[</span>

<span style="COLOR: #454580">-1</span>

<span style="COLOR: black">]</span>

.<span style="COLOR: black">bytes</span>

 += <span style="COLOR: #454580">2</span>

 * <span style="COLOR: black">(</span>

blankline<span style="COLOR: #454580">+1</span>

<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">lines</span>

.<span style="COLOR: black">append(</span>

Writer.<span style="COLOR: black">Paragraph())</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">def</span>

</strong>

 send_literal_data<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

, data<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">send_flowing_data(</span>

data<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">def</span>

</strong>

 send_line_break<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">send_paragraph(</span>

<span style="COLOR: #454580">0</span>

<span style="COLOR: black">)</span>

</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">This code doesn&rsquo;t do any outputting yet, it just gathers the data. We now have a bunch of paragraphs in an array, we know their length, and we know roughly how many bytes of HTML were necessary to create them. Let&rsquo;s see what emerge from our statistics.</span>

</div>
<div><span style="FONT-SIZE: 12pt">这里代码还没有做输出部分，它只是聚合数据。现在我们有一系列的文字段（用数组保存），以及它们的长度和生成它们所需要的HTML的大概字节数。现在让我们来看看统计学带来了什么。</span>

</div>
<div><strong><span style="FONT-SIZE: 13.5pt">Examining the Data</span>

</strong>

</div>
<div><strong><span style="FONT-SIZE: 13.5pt">数据分析</span>

</strong>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">Luckily, there are some patterns in the data. In the raw output below, you&rsquo;ll notice there are definite spikes in the number of HTML bytes required to encode lines of text, notably around the title, both sidebars, headers and footers.</span>

</div>
<div><span style="FONT-SIZE: 12pt">幸运的是，数据里总是存在一些模式。从下面的原始输出你可以发现有些文本需要大量的HTML来编码，特别是标题、侧边栏、页眉和页脚。</span>

</div>
<div><span style="FONT-SIZE: 12pt"><img src="http://ai-depot.com/articles/wp-content/uploads/2007/04/textvsbytes.png" alt="" />

</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">While the number of HTML bytes spikes in places, it remains below average for quite a few lines. On these lines, the text output is rather high. Calculating the density of text to HTML bytes gives us a better understanding of this relationship.</span>

</div>
<div><span style="FONT-SIZE: 12pt">虽然HTML字节数的峰值多次出现，但大部分仍然低于平均值；我们也可以看到在大部分低HTML字节数的字段中，文本输出却相当高。通过计算文本与HTML字节数的比率（即密度）可以让我们更容易明白它们之间的关系：</span>

</div>
<div><span style="FONT-SIZE: 12pt"><img src="http://ai-depot.com/articles/wp-content/uploads/2007/04/density.png" alt="" />

</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">The patterns are more obvious in this density value, so it gives us something concrete to work with.</span>

</div>
<div><span style="FONT-SIZE: 12pt">密度值图更加清晰地表达了正文的密度更高，这是我们的工作的事实依据。</span>

</div>
<div><strong><span style="FONT-SIZE: 13.5pt">Filtering the Lines</span>

</strong>

</div>
<div><strong><span style="FONT-SIZE: 13.5pt">过滤文本行</span>

</strong>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">The simplest way we can filter lines now is by comparing the density to a fixed threshold, such as 50% or the average density. Finishing the LineWriter class:</span>

</div>
<div><span style="FONT-SIZE: 12pt">过滤文本行的最简单方法是通过与一个阈值（如50%或者平均值）比较密度值。下面来完成LineWriter类：</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">def</span>

</strong>

 compute_density<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #48488b">&quot;&quot;&quot;Calculate the density for each line, and the average.&quot;&quot;&quot;</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total = <span style="COLOR: #454580">0.0</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">for</span>

</strong>

 l <strong><span style="COLOR: #7777ff">in</span>

</strong>

 <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">lines</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; l.<span style="COLOR: black">density</span>

 = <span style="COLOR: #a0a020">len</span>

<span style="COLOR: black">(</span>

l.<span style="COLOR: black">text)</span>

 / <span style="COLOR: #a0a020">float</span>

<span style="COLOR: black">(</span>

l.<span style="COLOR: black">bytes)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total += l.<span style="COLOR: black">density</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em><span style="COLOR: gray"># Store for optional use by the neural network.</span>

</em>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">average</span>

 = total / <span style="COLOR: #a0a020">float</span>

<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">len</span>

<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">lines))</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">def</span>

</strong>

 output<span style="COLOR: black">(</span>

<span style="COLOR: #a0a020">self</span>

<span style="COLOR: black">)</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span style="COLOR: #48488b">&quot;&quot;&quot;Return a string with the useless lines filtered out.&quot;&quot;&quot;</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">compute_density()</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output = <span style="COLOR: #808040">StringIO</span>

.<span style="COLOR: #808040">StringIO</span>

<span style="COLOR: black">()</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">for</span>

</strong>

 l <strong><span style="COLOR: #7777ff">in</span>

</strong>

 <span style="COLOR: #a0a020">self</span>

.<span style="COLOR: black">lines</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em><span style="COLOR: gray"># Check density against threshold.</span>

</em>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em><span style="COLOR: gray"># Custom filter extensions go here.</span>

</em>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="COLOR: #7777ff">if</span>

</strong>

 l.<span style="COLOR: black">density</span>

 &gt; <span style="COLOR: #454580">0.5</span>

:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output.<span style="COLOR: black">write(</span>

l.<span style="COLOR: black">text)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">return</span>

</strong>

 output.<span style="COLOR: black">getvalue()</span>

</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">This rough filter typically gets most of the lines right. All the headers, footers and sidebars text is usually stripped as long as it&rsquo;s not too long. However, if there are long copyright notices, comments, or descriptions of other stories, then those are output too. Also, if there are short lines around inline graphics or adverts within the text, these are not output.</span>

</div>
<div><span style="FONT-SIZE: 12pt">这个粗糙的过滤器能够获取大部分正确的文本行。只要页眉、页脚和侧边栏文本并不非常长，那么所有的这些都会被剔除。然而，它仍然会输出比较长的版本声明、注释和对其它故事的概述；在图片和广告周边的比较短小的文本，却被过滤掉了。</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">To fix this, we need a more complex filtering heuristic. But instead of spending days working out the logic manually, we&rsquo;ll just grab loads of information about each line and use machine learning to find patterns for us.</span>

</div>
<div><span style="FONT-SIZE: 12pt">要解决这个问题，我们需要更复杂些的启发式过滤器。为了节省手工计算需要花费的无数时间，我们将利用机器学习来处理每一文本行的信息，以找出对我们有用的模式。</span>

</div>
<div><strong><span style="FONT-SIZE: 13.5pt">Supervised Machine Learning</span>

</strong>

</div>
<div><strong><span style="FONT-SIZE: 13.5pt">监督式机器学习</span>

</strong>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">Here&rsquo;s an example of an interface for tagging lines of text as content or not:</span>

</div>
<div><span style="FONT-SIZE: 12pt">这是一个标识文本行是否为正文的接口界面：</span>

</div>
<div><span style="FONT-SIZE: 12pt"><img src="http://ai-depot.com/articles/wp-content/uploads/2007/04/training.png" alt="" />

</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">The idea of supervised learning is to provide examples for an algorithm to learn from. In our case, we give it a set documents that were tagged by humans, so we know which line must be output and which line must be filtered out. For this we&rsquo;ll use a simple neural network known as the perceptron. It takes floating point inputs and filters the information through weighted connections between &ldquo;neurons&rdquo; and outputs another floating point number. Roughly speaking, the number of neurons and layers affects the ability to approximate functions precisely; we&rsquo;ll use both single-layer perceptrons (SLP) and multi-layer perceptrons (MLP) for prototyping.</span>

</div>
<div><span style="FONT-SIZE: 12pt">所谓的监督式学习就是为算法提供学习的例子。在这个案例中，我们给定一系列已经由人标识好的文档&mdash;&mdash;我们知道哪一行必须输出或者过滤掉。我们用使用一个简单的神经网络作为感知器，它接受浮点输入并通过&ldquo;神经元&rdquo;间的加权连接过滤信息，然后输后另一个浮点数。大体来说，神经元数量和层数将影响获取最优解的能力。我们的原型将分别使用单层感知器（SLP）和多层感知器（MLP）模型。</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">To get the neural network to learn, we need to gather some data. This is where the earlier LineWriter.output() function comes in handy; it gives us a central point to process all the lines at once, and make a global decision which lines to output. Starting with intuition and experimenting a bit, we discover that the following data is useful to decide how to filter a line:</span>

</div>
<div><span style="FONT-SIZE: 12pt">我们需要找些数据来供机器学习。之前的LineWriter.output()函数正好派上用场，它使我们能够一次处理所有文本行并作出决定哪些文本行应该输出的全局结策。从直觉和经验中我们发现下面的几条原则可用于决定如何过滤文本行：</span>

</div>
<ul type="disc">
<li style="COLOR: silver; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">Density of the <strong>current</strong>

 line. </span>

</li>
<li style="TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">当前行的密度</span>

 </li>
<li style="COLOR: silver; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">Number of HTML bytes of the line. </span>

</li>
<li style="TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">当前行的HTML字节数</span>

 </li>
<li style="COLOR: silver; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">Length of output text for this line. </span>

</li>
<li style="TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">当前行的输出文本长度</span>

 </li>
<li style="COLOR: silver; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">These three values for the previous line, </span>

</li>
<li style="TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">前一行的这三个值</span>

 </li>
<li style="COLOR: silver; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&hellip; and the same for the next line. </span>

</li>
<li style="TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">后一行的这三个值</span>

 </li>
</ul>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">For the implementation, we&rsquo;ll be using Python to interface with FANN, the Fast Artificial Neural Network Library. The essence of the learning code goes like this:</span>

</div>
<div><span style="FONT-SIZE: 12pt">我们可以利用FANN的Python接口来实现，FANN是Fast Artificial Neural NetWork库的简称。基本的学习代码如下：</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><strong><span style="FONT-SIZE: 12pt; COLOR: #7777ff">from</span>

</strong>

<span style="FONT-SIZE: 12pt"> pyfann <strong><span style="COLOR: #7777ff">import</span>

</strong>

 fann, libfann</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><em><span style="FONT-SIZE: 12pt; COLOR: gray"># This creates a new single-layer perceptron with 1 output and 3 inputs.</span>

</em>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">obj = libfann.<span style="COLOR: black">fann_create_standard_array(</span>

<span style="COLOR: #454580">2</span>

, <span style="COLOR: black">(</span>

<span style="COLOR: #454580">3</span>

, <span style="COLOR: #454580">1</span>

<span style="COLOR: black">))</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">ann = fann.<span style="COLOR: black">fann_class(</span>

obj<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><em><span style="FONT-SIZE: 12pt; COLOR: gray"># Load the data we described above.</span>

</em>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">patterns = fann.<span style="COLOR: black">read_train_from_file(</span>

<span style="COLOR: #48488b">'training.txt'</span>

<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">ann.<span style="COLOR: black">train_on_data(</span>

patterns, <span style="COLOR: #454580">1000</span>

, <span style="COLOR: #454580">1</span>

, <span style="COLOR: #454580">0.0</span>

<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><em><span style="FONT-SIZE: 12pt; COLOR: gray"># Then test it with different data.</span>

</em>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><strong><span style="FONT-SIZE: 12pt; COLOR: #7777ff">for</span>

</strong>

<span style="FONT-SIZE: 12pt"> datin, datout <strong><span style="COLOR: #7777ff">in</span>

</strong>

 validation_data:</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; result = ann.<span style="COLOR: black">run(</span>

datin<span style="COLOR: black">)</span>

</span>

</div>
<div style="BACKGROUND: #ccffff; TEXT-ALIGN: left"><span style="FONT-SIZE: 12pt">&nbsp;&nbsp;&nbsp; <strong><span style="COLOR: #7777ff">print</span>

</strong>

 <span style="COLOR: #48488b">'Got:'</span>

, result, <span style="COLOR: #48488b">' Expected:'</span>

, datout</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">Trying out different data and different network structures is a rather mechanical process. Don&rsquo;t have too many neurons or you may train too well for the set of documents you have (overfitting), and conversely try to have enough to solve the problem well. Here are the results, varying the number of lines used (1L-3L) and the number of attributes per line (1A-3A):</span>

</div>
<div><span style="FONT-SIZE: 12pt">尝试不同的数据和不同的网络结构是比较机械的过程。不要使用太多的神经元和使用太好的文本集合来训练（过拟合），相反地应当尝试解决足够多的问题。使用不同的行数（1L-3L）和每一行不同的属性（1A-3A）得到的结果如下：</span>

</div>
<div><span style="FONT-SIZE: 12pt"><img src="http://ai-depot.com/articles/wp-content/uploads/2007/04/comparison.png" alt="" />

</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">The interesting thing to note is that 0.5 is already a pretty good guess at a fixed threshold (see first set of columns). The learning algorithm cannot find much better solution for comparing the density alone (1 Attribute in the second column). With 3 Attributes, the next SLP does better overall, though it gets more false negatives. Using multiple lines also increases the performance of the single layer perceptron (fourth set of columns). And finally, using a more complex neural network structure works best overall &mdash; making 80% less errors in filtering the lines.</span>

</div>
<div><span style="FONT-SIZE: 12pt">有趣的是作为一个猜测的固定阈值，0.5的表现非常好（看第一列）。学习算法并不能仅仅通过比较密度来找出更佳的方案（第二列）。使用三个属性，下一个SLP比前两都好，但它引入了更多的假阴性。使用多行文本也增进了性能（第四列），最后使用更复杂的神经网络结构比所有的结果都要更好，在文本行过滤中减少了80%错误。</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">Note that you can tweak how the error is calculated if you want to punish false positives more than false negatives.</span>

</div>
<div><em><span style="FONT-SIZE: 12pt">注意：你能够调整误差计算，以给假阳性比假阴性更多的惩罚（宁缺勿滥的策略）。</span>

</em>

</div>
<div><strong><span style="FONT-SIZE: 13.5pt">Conclusion</span>

</strong>

</div>
<div><strong><span style="FONT-SIZE: 13.5pt">结论</span>

</strong>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">Extracting text from arbitrary HTML files doesn&rsquo;t necessarily require scraping the file with custom code. You can use statistics to get pretty amazing results, and machine learning to get even better. By tweaking the threshold, you can avoid the worst false positive that pollute your text output. But it&rsquo;s not so bad in practice; where the neural network makes mistakes, even humans have trouble classifying those lines as &ldquo;content&rdquo; or not.</span>

</div>
<div><span style="FONT-SIZE: 12pt">从任意HTML文件中抽取正文无需编写针对文件编写特定的抽取程序，使用统计学就能获得令人惊讶的效果，而机器学习能让它做得更好。通过调整阈值，你能够避免出现鱼目混珠的情况。它的表现相当好，因为在神经网络判断错误的地方，甚至人类也难以判定它是否为正文。</span>

</div>
<div><span style="FONT-SIZE: 12pt; COLOR: silver">Now all you have to figure out is what to do with that clean text content!</span>

</div>
<div><span style="FONT-SIZE: 12pt">现在需要思考的问题是用这些&ldquo;干净&rdquo;的正文内容做什么应用好呢？</span>

</div>
<p>&nbsp;</p>    
</div>




<!-- Baidu Button BEGIN -->




<div class="bdsharebuttonbox" style="float: right;">
<a href="#" class="bds_more" data-cmd="more" style="background-position:0 0 !important; background-image: url(http://bdimg.share.baidu.com/static/api/img/share/icons_0_16.png?v=d754dcc0.png) !important"></a>
<a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"  style="background-position:0 -52px !important"></a>
<a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"style="background-position:0 -104px !important"></a>
<a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"style="background-position:0 -260px !important"></a>
<a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"style="background-position:0 -208px !important"></a>
<a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"style="background-position:0 -1612px !important" ></a>
</div>
<script>window._bd_share_config = { "common": { "bdSnsKey": {}, "bdText": "", "bdMini": "1", "bdMiniList": false, "bdPic": "", "bdStyle": "0", "bdSize": "16" }, "share": {} }; with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];</script>
<!-- Baidu Button END -->

   <link rel="stylesheet" href="http://static.blog.csdn.net/css/blog_detail.css" />

    
<!--172.16.140.11-->
<ul class="article_next_prev">
            <li class="prev_article"><span  onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_shangyipian']);location.href='/gzlaiyonghao/article/details/1734990';">上一篇</span><a href="/gzlaiyonghao/article/details/1734990" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_shangyipian'])">理解Python命名机制</a></li>
            <li class="next_article"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_xiayipian']);location.href='/gzlaiyonghao/article/details/1746852';">下一篇</span><a href="/gzlaiyonghao/article/details/1746852" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_xiayipian'])">程序员必知必会之blog篇</a></li>
</ul>

<!-- Baidu Button BEGIN -->
<script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=1536434" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
    document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)
</script>
<!-- Baidu Button END -->

 

      
</div>
<div id="suggest"></div>
         <script  language="javascript" type='text/javascript'>     
             $(function(){
                 $.get("/lanphaday/svc/GetSuggestContent/1741185",function(data){
                     $("#suggest").html(data);
                 });     
             });             
         </script>  


<style>
.blog-ass-articl dd {
color: #369;
width: 99%; /*修改行*/
float: left;
overflow: hidden;
font: normal normal 12px/23px "SimSun";
height: 23px;
margin: 0;
padding: 0 0 0 10px;
margin-right: 30px;
background: url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;
}
</style>

<dl class="blog-ass-articl" id="res-relatived" > 
     <dt><span>猜你在找</span></dt>    


   


    <div id="adCollege" style="width: 42%;float: left;"> 
        <script src="http://csdnimg.cn/jobreco/job_reco.js" type="text/javascript"></script> 
        <script type="text/javascript">
            csdn.position.showEdu({
                sourceType: "blog",
                searchType: "detail",
                searchKey: "1741185",
                username: "huangxx",
                recordcount: "5",
                containerId: "adCollege" //容器DIV的id。 
            });
        </script> 
    </div>  

    
     <div id="res"  data-mod="popu_36"  class="tracking-ad" style="width: 42%;float: left;margin-right: 30px;"></div>
   
</dl>

<div id="job_blog_reco">
<script src="http://c.csdnimg.cn/jobreco/job_reco.js" type="text/javascript"></script>
   
     <script type="text/javascript">
         csdn.position.show({
         sourceType: "blog",
         tplType: "blogDetail",
         searchType: "detail",
         searchKey: "1741185",
             username: "huangxx",
         containerId: "job_blog_reco"
        }); 
    </script>

</div>

<script type="text/javascript">
    $(function () {
        setTimeout(function () {
            var searchtitletags = '从HTML文件中抽取正文的简单方案' + ',' + $("#tags").html();
            searchService({
                index: 'blog',
                query: searchtitletags,
                from: 5,
                size: 5,
                appendTo: '#res',
                url: 'recommend',
                his: 2,
                client: "blog_cf_enhance",
                tmpl: '<dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="#{ url }" title="#{ title }" strategy="#{ strategy }">#{ title }</a></dd>'
            });
        }, 500);
    });    

 </script>   

    <div id="ad_cen">
   
          <script type="text/javascript">
              new Ad(4, 'ad_cen');
          </script>
    </div>
<div class="comment_class">
    <div id="comment_title" class="panel_head">
        <span class="see_comment">查看评论</span><a name="comments"></a></div>
    <div id="comment_list">
    </div>
    <div id="comment_bar">
    </div>
    <div id="comment_form">
    </div>

    <div class="announce">
        * 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a name="reply"></a><a name="quote"></a></div>
</div>

<script type="text/javascript">
    var fileName = '1741185';
    var commentscount = 24;
    var islock = false
</script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/comment.js"></script>
    <div id="ad_bot">
    </div>
    <script type="text/javascript">
        setTimeout(function(){
            new Ad(5, 'ad_bot');
        },500);  
    </script>
<div id="report_dialog">
</div>

<div id="d-top"  style="bottom:60px;">
        <a id="quick-reply" class="btn btn-top q-reply" title="快速回复" style="display:none;">
            <img src="http://static.blog.csdn.net/images/blog-icon-reply.png" alt="快速回复">
        </a>    

    <a id="d-top-a" class="btn btn-top backtop"  style="display: none;" title="返回顶部" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_huidaodingbu'])" style="">         
         <img src="http://static.blog.csdn.net/images/top.png" alt="TOP">
    </a>
</div>
<script type="text/javascript">
    $(function ()
    {
        $("#ad_frm_0").height("90px");
        
        setTimeout(function(){
            $("#ad_frm_2").height("200px");
        },1000);    
    });
  
</script>
<style type="text/css">
    .tag_list
    {
        background: none repeat scroll 0 0 #FFFFFF;
        border: 1px solid #D7CBC1;
        color: #000000;
        font-size: 12px;
        line-height: 20px;
        list-style: none outside none;
        margin: 10px 2% 0 1%;
        padding: 1px;
    }
    .tag_list h5
    {
        background: none repeat scroll 0 0 #E0DBD3;
        color: #47381C;
        font-size: 12px;
        height: 24px;
        line-height: 24px;
        padding: 0 5px;
        margin: 0;
    }
    .tag_list h5 a
    {
        color: #47381C;
    }
    .classify
    {
        margin: 10px 0;
        padding: 4px 12px 8px;
    }
    .classify a
    {
        margin-right: 20px;
        white-space: nowrap;
    }
</style>


<div class="tag_list" style="display:none"></div>
  <script  language="javascript" type='text/javascript'>     
      $(function(){
              setTimeout(function(){
                  $.get("/lanphaday/svc/GetTagContent",function(data){
                      $(".tag_list").html(data).show();
                  });     
              });
          },500);                       
 </script> 


<div id="pop_win" style="display:none ;position: absolute; z-index: 10000; border: 1px solid rgb(220, 220, 220); top: 222.5px; left: 630px; opacity: 1; background: none 0px 0px repeat scroll rgb(255, 255, 255);">
    
</div>
<div id="popup_mask"></div>
<style>
    #popup_mask
    {
        position: absolute;
        width: 100%;
        height: 100%;
        background: #000;
        z-index: 9999;
        left: 0px;
        top: 0px;
        opacity: 0.3;
        filter: alpha(opacity=30);
        display: none;
    }

</style>




<script type="text/javascript">
    $(function(){
        setTimeout(function(){
            $(".comment_body:contains('回复')").each(function(index,item){
                var u=$(this).text().split('：')[0].toString().replace("回复","")
                var thisComment=$(this);
                if(u)
                {
                    $.getJSON("https://passport.csdn.net/get/nick?callback=?", {users: u}, function(a) {
                        if(a!=null&&a.data!=null&&a.data.length>0)
                        {
                            nick=a.data[0].n; 
                            if(u!=nick)
                            {
                                thisComment.text(thisComment.text().replace(u,nick));  
                            }
                        }       
                    });  
                }
            });
        },200);  
        
        setTimeout(function(){
            $("a img[src='http://js.tongji.linezing.com/stats.gif']").parent().css({"position":"absolute","left":"50%"});
        },300);
    });

    function loginbox(){
        var $logpop=$("#pop_win");
        $logpop.html('<iframe src="https://passport.csdn.net/account/loginbox?service=http://static.blog.csdn.net/callback.htm" frameborder="0" height="600" width="400" scrolling="no"></iframe>');

        $('#popup_mask').css({
            opacity: 0.5,
            width: $( document ).width() + 'px',
            height:  $( document ).height() + 'px'
        });
        $('#popup_mask').css("display","block");
 
        $logpop.css( {
            top: ($( window ).height() - $logpop.height())/ 2  + $( window 
       ).scrollTop() + 'px',
            left:($( window ).width() - $logpop.width())/ 2
        } );
 
        setTimeout( function () {
            $logpop.show();
            $logpop.css( {
                opacity: 1
            } );
        }, 200 );
 
        $('#popup_mask').unbind("click");
        $('#popup_mask').bind("click", function(){
            $('#popup_mask').hide();
            var $clopop = $("#pop_win");
            $("#common_ask_div_sc").css("display","none");
            $clopop.css( {
                opacity: 0
            } );
            setTimeout( function () {
                $clopop.hide();
            }, 350 );
            return false;
        });
    }    

</script>
                        <div class="clear">
                        </div>
                    </div>                   
                
            </div>
                   
           <div id="side">
    <div class="side">
                        <div id="Search"></div>
                         <script  language="javascript" type='text/javascript'>
                             $(function () {
                                 var time ='0';
                                 setTimeout(function () {
                                     $.get("/lanphaday/svc/GetColumnByTypeContent?ColumnType=search&UserName=lanphaday", function (data) {
                                         $("#Search").html(data);
                                         if ('search' == 'profile')
                                         {
                                              var un = getUN().toLowerCase();
                                                 if (un == _blogger.toLowerCase()) {
                                                     $('.interact').hide();
                                                 } else if (un) {
                                                     set_guanzhu_status(un);
                                                 } else {
                                                     if (un != "") {
                                                         $('#span_add_follow')[0].onclick = (function() {
                                                             loginto(0);
                                                         });
                                                     }
                                                 }
                                         }
                                         else if ('search' == 'search')
                                         {
                                             $("#btnSubmit").click(function () {
                                                 var key = $("#inputSearch").val();
                                                 if (key == "") {
                                                     alert("请输入搜索关键字");
                                                     $("#inputSearch").focus();
                                                     return false;
                                                 }
                                                 $("#inputQ").val('blog:' + username + ' ' + key);
                                                 return true;
                                             });                                            
                                         }
                                         else if ('search' == 'archive')
                                         {                                           
                                             initArchives();                                          
                                         }
                                         });
                                     },parseInt(time));
                                 });                                 
                          </script>   
                        <div id="Profile"></div>
                         <script  language="javascript" type='text/javascript'>
                             $(function () {
                                 var time ='100';
                                 setTimeout(function () {
                                     $.get("/lanphaday/svc/GetColumnByTypeContent?ColumnType=profile&UserName=lanphaday", function (data) {
                                         $("#Profile").html(data);
                                         if ('profile' == 'profile')
                                         {
                                              var un = getUN().toLowerCase();
                                                 if (un == _blogger.toLowerCase()) {
                                                     $('.interact').hide();
                                                 } else if (un) {
                                                     set_guanzhu_status(un);
                                                 } else {
                                                     if (un != "") {
                                                         $('#span_add_follow')[0].onclick = (function() {
                                                             loginto(0);
                                                         });
                                                     }
                                                 }
                                         }
                                         else if ('profile' == 'search')
                                         {
                                             $("#btnSubmit").click(function () {
                                                 var key = $("#inputSearch").val();
                                                 if (key == "") {
                                                     alert("请输入搜索关键字");
                                                     $("#inputSearch").focus();
                                                     return false;
                                                 }
                                                 $("#inputQ").val('blog:' + username + ' ' + key);
                                                 return true;
                                             });                                            
                                         }
                                         else if ('profile' == 'archive')
                                         {                                           
                                             initArchives();                                          
                                         }
                                         });
                                     },parseInt(time));
                                 });                                 
                          </script>   


<div id="custom_column_8615922" class="panel">
<ul class="panel_head"><span>weibo</span></ul>
<ul class="panel_body">
<iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=0&noborder=1&isWeibo=1&isFans=0&uid=1924010407&verifier=240a04bd&dpc=1"></iframe>
</ul>
</div>                        <div id="ViewCountArticles"></div>
                         <script  language="javascript" type='text/javascript'>
                             $(function () {
                                 var time ='200';
                                 setTimeout(function () {
                                     $.get("/lanphaday/svc/GetColumnByTypeContent?ColumnType=viewcountarticles&UserName=lanphaday", function (data) {
                                         $("#ViewCountArticles").html(data);
                                         if ('viewcountarticles' == 'profile')
                                         {
                                              var un = getUN().toLowerCase();
                                                 if (un == _blogger.toLowerCase()) {
                                                     $('.interact').hide();
                                                 } else if (un) {
                                                     set_guanzhu_status(un);
                                                 } else {
                                                     if (un != "") {
                                                         $('#span_add_follow')[0].onclick = (function() {
                                                             loginto(0);
                                                         });
                                                     }
                                                 }
                                         }
                                         else if ('viewcountarticles' == 'search')
                                         {
                                             $("#btnSubmit").click(function () {
                                                 var key = $("#inputSearch").val();
                                                 if (key == "") {
                                                     alert("请输入搜索关键字");
                                                     $("#inputSearch").focus();
                                                     return false;
                                                 }
                                                 $("#inputQ").val('blog:' + username + ' ' + key);
                                                 return true;
                                             });                                            
                                         }
                                         else if ('viewcountarticles' == 'archive')
                                         {                                           
                                             initArchives();                                          
                                         }
                                         });
                                     },parseInt(time));
                                 });                                 
                          </script>   
                        <div id="SpecialColumn"></div>
                         <script  language="javascript" type='text/javascript'>
                             $(function () {
                                 var time ='300';
                                 setTimeout(function () {
                                     $.get("/lanphaday/svc/GetColumnByTypeContent?ColumnType=specialcolumn&UserName=lanphaday", function (data) {
                                         $("#SpecialColumn").html(data);
                                         if ('specialcolumn' == 'profile')
                                         {
                                              var un = getUN().toLowerCase();
                                                 if (un == _blogger.toLowerCase()) {
                                                     $('.interact').hide();
                                                 } else if (un) {
                                                     set_guanzhu_status(un);
                                                 } else {
                                                     if (un != "") {
                                                         $('#span_add_follow')[0].onclick = (function() {
                                                             loginto(0);
                                                         });
                                                     }
                                                 }
                                         }
                                         else if ('specialcolumn' == 'search')
                                         {
                                             $("#btnSubmit").click(function () {
                                                 var key = $("#inputSearch").val();
                                                 if (key == "") {
                                                     alert("请输入搜索关键字");
                                                     $("#inputSearch").focus();
                                                     return false;
                                                 }
                                                 $("#inputQ").val('blog:' + username + ' ' + key);
                                                 return true;
                                             });                                            
                                         }
                                         else if ('specialcolumn' == 'archive')
                                         {                                           
                                             initArchives();                                          
                                         }
                                         });
                                     },parseInt(time));
                                 });                                 
                          </script>   
                        <div id="NewComments"></div>
                         <script  language="javascript" type='text/javascript'>
                             $(function () {
                                 var time ='400';
                                 setTimeout(function () {
                                     $.get("/lanphaday/svc/GetColumnByTypeContent?ColumnType=newcomments&UserName=lanphaday", function (data) {
                                         $("#NewComments").html(data);
                                         if ('newcomments' == 'profile')
                                         {
                                              var un = getUN().toLowerCase();
                                                 if (un == _blogger.toLowerCase()) {
                                                     $('.interact').hide();
                                                 } else if (un) {
                                                     set_guanzhu_status(un);
                                                 } else {
                                                     if (un != "") {
                                                         $('#span_add_follow')[0].onclick = (function() {
                                                             loginto(0);
                                                         });
                                                     }
                                                 }
                                         }
                                         else if ('newcomments' == 'search')
                                         {
                                             $("#btnSubmit").click(function () {
                                                 var key = $("#inputSearch").val();
                                                 if (key == "") {
                                                     alert("请输入搜索关键字");
                                                     $("#inputSearch").focus();
                                                     return false;
                                                 }
                                                 $("#inputQ").val('blog:' + username + ' ' + key);
                                                 return true;
                                             });                                            
                                         }
                                         else if ('newcomments' == 'archive')
                                         {                                           
                                             initArchives();                                          
                                         }
                                         });
                                     },parseInt(time));
                                 });                                 
                          </script>   
                        <div id="Archive"></div>
                         <script  language="javascript" type='text/javascript'>
                             $(function () {
                                 var time ='500';
                                 setTimeout(function () {
                                     $.get("/lanphaday/svc/GetColumnByTypeContent?ColumnType=archive&UserName=lanphaday", function (data) {
                                         $("#Archive").html(data);
                                         if ('archive' == 'profile')
                                         {
                                              var un = getUN().toLowerCase();
                                                 if (un == _blogger.toLowerCase()) {
                                                     $('.interact').hide();
                                                 } else if (un) {
                                                     set_guanzhu_status(un);
                                                 } else {
                                                     if (un != "") {
                                                         $('#span_add_follow')[0].onclick = (function() {
                                                             loginto(0);
                                                         });
                                                     }
                                                 }
                                         }
                                         else if ('archive' == 'search')
                                         {
                                             $("#btnSubmit").click(function () {
                                                 var key = $("#inputSearch").val();
                                                 if (key == "") {
                                                     alert("请输入搜索关键字");
                                                     $("#inputSearch").focus();
                                                     return false;
                                                 }
                                                 $("#inputQ").val('blog:' + username + ' ' + key);
                                                 return true;
                                             });                                            
                                         }
                                         else if ('archive' == 'archive')
                                         {                                           
                                             initArchives();                                          
                                         }
                                         });
                                     },parseInt(time));
                                 });                                 
                          </script>   


<div id="custom_column_955236" class="panel">
<ul class="panel_head"><span>编程语言</span></ul>
<ul class="panel_body">
<ul><li><a href="http://shootout.alioth.debian.org/gp4/benchmark.php?test=all&amp;amp;amp;lang=all" target="_blank">性能排名</a></li><li><a href="http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html" target="_blank">TIOBE 流行度</a></li><li><a href="http://langpop.com/" target="_blank">LangPop 流行度</a></li><li><a href="http://lang-index.sourceforge.net/" target="_blank">透明排行榜</a></li>

<li><a href="https://github.com/languages" target="_blank">Github top lang</a></li>

<li><a href="http://www.statisticbrain.com/computer-programming-language-statistics/" target="_blank">Computer Programming Language Statistics</a></li>

<li><a href="http://db-engines.com/en/ranking" target="_blank">DB Engines</a></li>


</ul>
</ul>
</div>    </div>
    <div class="clear">
    </div>
 </div>   
            <div class="clear">
            </div>
        </div>
        

<script type="text/javascript" src="http://c.csdnimg.cn/rabbit/cnick/cnick.js"></script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/newblog.min.js"></script>


<script type="text/javascript" src="http://medal.blog.csdn.net/showblogmedal.ashx?blogid=57230"></script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/JavaScript1.js"></script>

    <script type="text/javascript" src="http://js.tongji.linezing.com/2673176/tongji.js"></script>
<script type="text/javascript">document.write("<img src=http://counter.csdn.net/pv.aspx?id=24 border=0 width=0 height=0>");</script>
<script type="text/javascript" src="http://www.csdn.net/ui/scripts/Csdn/counter.js"></script>
<script type="text/javascript" src="http://ad.csdn.net/scripts/ad-blog.js"></script>
<script type="text/javascript" src="http://zz.csdn.net/js/count.js"></script>
<script type="text/javascript">
    $(function () {
        function __get_code_toolbar(snippet_id) {
            return $("<a href='https://code.csdn.net/snippets/"
                    + snippet_id
                    + "' target='_blank' title='在CODE上查看代码片' style='text-indent:0;'><img src='https://code.csdn.net/assets/CODE_ico.png' width=12 height=12 alt='在CODE上查看代码片' style='position:relative;top:1px;left:2px;'/></a>"
                    + "<a href='https://code.csdn.net/snippets/"
                    + snippet_id
                    + "/fork' target='_blank' title='派生到我的代码片'  style='text-indent:0;'><img src='https://code.csdn.net/assets/ico_fork.svg' width=12 height=12 alt='派生到我的代码片' style='position:relative;top:2px;left:2px;'/></a>");
        }
        
        $("[code_snippet_id]").each(function () {
            __s_id = $(this).attr("code_snippet_id");
            if (__s_id != null && __s_id != "" && __s_id != 0 && parseInt(__s_id) > 70020) {
                __code_tool = __get_code_toolbar(__s_id);
                $(this).prev().find(".tools").append(__code_tool);
            }
        });
    });
</script>




    </div>
      <!--new top-->
    
    <script id="csdn-toolbar-id" btnId="header_notice_num" wrapId="note1" count="5" subCount="5" type="text/javascript" src="http://static.csdn.net/public/common/toolbar/js/toolbar.js"></script>     <!--new top-->
   
    <link href="http://c.csdnimg.cn/comm_ask/css/ask_float_block.css" type="text/css" rel="stylesheet" />
    <script language='JavaScript' type='text/javascript' src='http://c.csdnimg.cn/comm_ask/js/libs/wmd.js'></script>
    <script language='JavaScript' type='text/javascript' src='http://c.csdnimg.cn/comm_ask/js/libs/showdown.js'></script>
    <script language='JavaScript' type='text/javascript' src='http://c.csdnimg.cn/comm_ask/js/libs/prettify.js'></script>
    <script language='JavaScript' type='text/javascript' src='http://c.csdnimg.cn/comm_ask/js/apps/ask_float_block.js'></script>
   
</body>
</html>   
 